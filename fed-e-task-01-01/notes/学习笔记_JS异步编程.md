# JS异步编程 (Functional Programming)

### 同步模式

程序执行顺序与代码编写顺序一致，所以当遇到执行时间长的任务，会造成程序阻塞。

### 异步模式

当程序阻塞时，或需要大文件操作时，需要用异步调用执行代码，从而避免程序卡死。
开启异步模式，异步任务进度消息队列，程序不会等待异步任务完成，而是执行下一个同步任务。
直到同步任务完成，EventLoop会读取消息队列任务，将任务放到主线程执行异步任务。

### 回调函数 (callbacks)

回调函数可以作为参数传递给异步任务，当异步代码执行完成，就调用回调函数。
但不是所有回调函数都是异步执行，例如Array.prototype.forEach()中的回调函数就是同步执行。

### 消息队列

类似promise的异步操作在执行时，会被放入消息队列中，在主线程执行结束后，消息队列中的方法才执行。
消息队列有两种，一种是宏任务队列，一种是微任务队列。
每次执行宏任务之前，程序都会查看微任务队列是否还有未执行的微任务，如果有，优先执行微任务队列的任务。

### promise 异步编程方案

1. 回调函数可以在promise状态确定后再传给promise。
2. 可用then()将多个异步操作链接在一起，这回避免传统回调函数方案的回调地狱。
3. 错误处理方便，可以由末尾的catch()处理。

### Generator 异步编程方案

利用Generator的yield特性，手动控制代码向下执行。

### async异步编程方案

async是promise的语法糖，使代码更容易编写，可读性更高。
async关键词放在函数声明之前，将函数编程async 函数，返回一个promise。
await关键词只能放在async函数内部。
